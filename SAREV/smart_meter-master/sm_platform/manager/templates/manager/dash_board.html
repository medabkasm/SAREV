{%	extends	"base.html"	%}
{% load i18n %}
{% load static %}
{% block title %}<title>
  {% trans "dash board" %}
</title>
{% endblock title %}
{% block css %}
<!-- CSS only -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" />
<!-- Favicons -->

<style>
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        user-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }
    </style>

<link rel="stylesheet" type="text/css" href='{% static "manager/dash_board.css" %}'>
{% endblock css %}
{% block js %}
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/feather-icons@4.28.0/dist/feather.min.js" integrity="sha384-uO3SXW5IuS1ZpFPKugNNWqTZRRglnUJK6UAZ/gxOX80nxEkN9NcGZTftn6RzhGWE" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js" integrity="sha384-zNy6FEbO50N+Cg5wap8IKA4M/ZnLJgzc6w2NqACZaK0u0FXfOWRRJOnQtpZun8ha" crossorigin="anonymous"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script type="text/javascript" src="{% static 'manager/dash_board.js' %}"></script>

{% endblock js %}

{% block content %}

<header class="navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0">
<a class="navbar-brand col-md-3 col-lg-2 me-0 px-3" href="#">    <img  class="text-right align-top" id="hat" src="{% static 'accounts/Logo_sonelgaz.png' %}" alt="" width="30" height="30" >

</a>
<button id="searchButt" class="navbar-toggler position-absolute d-md-none collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#sidebarMenu" aria-controls="sidebarMenu" aria-expanded="false" aria-label="Toggle navigation">
  <span class="navbar-toggler-icon"></span>
</button>
<input id="search" data-pageType="" class="form-control form-control-dark w-100" type="text" placeholder="Search" aria-label="Search">
<div class="navbar-nav">
  <div class="nav-item text-nowrap">
    <a class="nav-link px-3" href="{% url 'accounts:logout' %}">{% trans "Logout" %}<span data-feather="log-out"></span></i></a>
  </div>
</div>
</header>

<div class="container-fluid">
<div class="row">
  <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
    <div class="position-sticky pt-3">
      <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
        <span>{% trans "profile settings" %}</span>
          <span data-feather="settings"></span>
      </h6>
      <ul class="nav flex-column">
        <li class="nav-item">
          <a class="nav-link" href="{% url 'profiles:profile' user.username %}">
            <span data-feather="user"></span>
            {% trans "Profile" %}
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="{% url 'accounts:password_change' user.username %}">
            <span data-feather="eye"></span>
            {% trans "Change Password" %}
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="{% url 'accounts:delete_account' user.username %}">
            <span data-feather="alert-triangle"></span>
            {% trans "Delete Account" %}
          </a>
        </li>
      </ul>

      <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
        <span>{% trans "Usage" %}</span>
          <span data-feather="zap"></span>
      </h6>
      <ul class="nav flex-column mb-2">
        {% if user.employee or user.is_admin %}
        <li id="getBillsEmp" class="nav-item">
          <a class="nav-link" href="#">
            <span data-feather="credit-card"></span>
            {% trans "Bills" %}
          </a>
        </li>
        <li id="getUsersEmp" class="nav-item">
          <a class="nav-link" href="#">
            <span data-feather="users"></span>
            {% trans "New Users" %}
          </a>
        </li>
        {% else %}
        <li id="getBills" class="nav-item">
          <a class="nav-link" href="#">
            <span data-feather="credit-card"></span>
            {% trans "Bills" %}
          </a>
        </li>
        <li id="getChart" class="nav-item">
          <a class="nav-link" href="#">
            <span data-feather="activity"></span>
            {% trans "Consumption Chart" %}
          </a>
        </li>
        {% endif %}
      </ul>
    </div>
  </nav>

  <main id="main" class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
  {% include "accounts/messages.html" %}
  {% if user.employee or user.is_admin %}
  <div id="usersEmp" class="table-responsive">
    <h2>{% trans "New Users" %}</h2>
    <table class="table table-striped table-sm">
      <thead>
        <tr>
          <th scope="col">ID</th>
          <th scope="col">{% trans "username" %}</th>
          <th scope="col">{% trans "email" %}</th>
          <th scope="col">{% trans "phone" %}</th>
          <th scope="col">{% trans "date" %}</th>
          <th scope="col">{% trans "status" %}</th>
        </tr>
      </thead>
      <tbody id="usersEmpTab">
      </tbody>
    </table>
  </div>

  <div id="billsEmp" class="table-responsive">
    <h2>{% trans "Unpayed Bills" %}</h2>
    <table class="table table-striped table-sm">
      <thead>
        <tr>
          <th scope="col">ID</th>
          <th scope="col">{% trans "username" %}</th>
          <th scope="col">{% trans "power" %}</th>
          <th scope="col">{% trans "amount" %}</th>
          <th scope="col">{% trans "date" %}</th>
          <th scope="col">{% trans "status" %}</th>
        </tr>
      </thead>
      <tbody id="billsEmpTab">
      </tbody>
    </table>
  </div>

  {% else %}

  <div id="alert" class="alert alert-danger" role="alert">
    {% trans "No data Found" %}
  </div>
    <div id="chart">
      <h2>{% trans "Power Consumption Chart" %}</h2>
      <canvas  class="my-4 w-100" id="myChart" width="900" height="380"></canvas>
      <h2>{% trans "Current Consumption Chart" %}</h2>
      <canvas  class="my-4 w-100" id="myChart2" width="900" height="380"></canvas>
    </div>

    <div id="table" class="table-responsive">
      <h2>{% trans "Bills" %}</h2>
      <table class="table table-striped table-sm">
        <thead>
          <tr>
            <th scope="col">ID</th>
            <th scope="col">{% trans "Date" %}</th>
            <th scope="col">{% trans "Voltage(V)" %}</th>
            <th scope="col">{% trans "Average Current(A)" %}</th>
            <th scope="col">{% trans "Power(W)" %}</th>
            <th scope="col">{% trans "Status" %}</th>
          </tr>
        </thead>
        <tbody>
          {% if bills %}
            {% for bill in bills %}
            <tr>
              <td><a href="{% url 'manager:get_bill' user.username bill.id %}">{{bill.id}}</a></td>
              <td>{{bill.date}}</td>
              <td>{{bill.voltage|floatformat:3}}</td>
              <td>{{bill.avgCurrent|floatformat:3}}</td>
              <td>{{bill.power|floatformat:3}}</td>
            </tr>
            {% endfor %}
          {% endif %}
        </tbody>
      </table>
    </div>
    {% endif %}


  </main>
</div>
</div>


{% endblock content %}
